<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ระบบค้นหาข้อมูลนักเรียน</title>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Prompt', sans-serif;
      background: #fefefe;
      padding: 2em 1em;
      text-align: center;
    }
    h1 { color: #e65100; font-size: 2em; margin-bottom: 0.3em; }
    .subtitle { margin-bottom: 1em; font-size: 1.1em; }
    input, button {
      font-size: 1em;
      padding: 0.8em;
      max-width: 350px;
      width: 100%;
      margin: 0.5em auto;
      box-sizing: border-box;
      display: block;
    }
    button {
      background-color: #ff7043;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .result {
      margin-top: 2em;
      background: #fff;
      padding: 1.5em;
      border-radius: 10px;
      max-width: 450px;
      margin-left: auto;
      margin-right: auto;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      text-align: left;
      display: none;
    }
  </style>
</head>
<body>
  <h1>ระบบค้นหาข้อมูลนักเรียน</h1>
  <p class="subtitle"><strong>คณะสีแสด</strong></p>
  <input id="studentId" placeholder="กรอกรหัสประจำตัวนักเรียน" />
  <button onclick="searchStudent()">ค้นหา</button>
  <div id="result" class="result"></div>

  <script>
    async function searchStudent() {
      const id = document.getElementById("studentId").value.trim();
      if (!id) return;

      const res = await fetch(`https://script.google.com/macros/s/AKfycbw4ytu5rJr4KbrBGV87hqsw-xqVSzOQS-Jq1OppaHDM4sNbq2XKWEZmZHoJmjjDSHslXw/exec?studentId=${id}`);
      const data = await res.json();

      const resultDiv = document.getElementById("result");
      resultDiv.style.display = "block";

      if (data.status === "success") {
        resultDiv.innerHTML = `
          <strong>ห้อง:</strong> ${data.room}<br>
          <strong>เลขที่:</strong> ${data.number}<br>
          <strong>ชื่อ:</strong> ${data.prefix} ${data.firstname} ${data.lastname}<br>
          ${data.roles.map((r, i) => r ? `<strong>หน้าที่ ${i+1}:</strong> ${r}<br>` : '').join('')}
        `;
      } else {
        resultDiv.innerHTML = `
          <strong style="color: #d32f2f;">ไม่พบข้อมูลในฐานข้อมูลคณะสีแสด</strong><br>
          หากคิดว่าเป็นความผิดพลาดของระบบ กรุณาติดต่อ <a href="https://line.me/ti/p/rRULUuwLC7" target="_blank">LINE เจ้าหน้าที่</a>
        `;
      }
    }
  </script>
</body>
</html>
